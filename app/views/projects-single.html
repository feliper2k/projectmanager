<nav ng-include="'navigation.html'" class="nav__top"></nav>
<div class="container view__projects--single">
    <!-- <div class="row text-right">
        <button class="btn btn-default" ng-click="main.login.signOut()">Wyloguj</button>
    </div> -->
    <p>
        <a ui-sref="ProjectsList"><i class="fa fa-chevron-left"></i>Powrót</a>
    </p>

    <div class="row">
        <section class="view__projects-description col-md-6">
            <h2>{{ project.current.name }}</h2>
            <p>{{ project.current.description }}</p>
        </section>

        <section class="view__projects-meta col-md-6">
            <!-- <div>
                <i class="fa fa-clock-o"></i> <strong>Czas spędzony nad projektem: </strong> <span ng-bind="">[czas]</span>
            </div> -->
            <div class="meta-row">
                <i class="fa fa-key"></i> <strong>Menedżer projektu: </strong> <span>{{ project.current.ownername }}</span>
            </div>
            <div class="meta-row">
                <i class="fa fa-calendar-o"></i> <strong>Deadline: </strong> <span>{{ project.current.duedate | date:'dd/MM/yyyy HH:mm' }}</span>
            </div>
            <!-- <div>
                <i class="fa fa-clock-o"></i> <strong>Uczestnicy: </strong> <span>...</span> <a href="#">Edytuj...</a>
            </div> -->
        </section>
    </div>

    <div>
        <button class="btn" ng-click="project.editor.visible = !project.editor.visible"
        ng-class="{ 'btn-default': project.editor.visible, 'btn-primary': !project.editor.visible }" ng-disabled="!main.tokenData().admin">
            <i class="fa fa-pencil"></i> Edytuj
        </button>
    </div>

    <div ng-if="project.editor.visible">
        <form ng-submit="project.actions.save()" class="form-horizontal form-add-user">
            <div class="form-group">
                <label for="newProjectName" class="col-sm-2">Nazwa projektu</label>
                <div class="col-sm-10">
                    <input type="text" ng-model="project.current.name" class="form-control" id="newProjectName" required>
                </div>
            </div>
            <div class="form-group">
                <label for="newProjectManager" class="col-sm-2">Zarządzca</label>
                <div class="col-sm-10">
                    <select ng-model="project.current.owner" class="form-control" id="newProjectDescription" required>
                        <option ng-repeat="owner in project.owners" value="{{ owner.id }}">{{ owner.displayname }}</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="newProjectDescription" class="col-sm-2">Opis</label>
                <div class="col-sm-10">
                    <textarea ng-model="project.current.description" class="form-control" id="newProjectDescription" required>
                    </textarea>
                </div>
            </div>
            <!-- <div class="form-group">
                <label for="newProjectDeadline" class="col-sm-2">Deadline</label>
                <div class="col-sm-5">
                    <input type="text" ng-model="project.current.dldate" placeholder="Format: DD/MM/RRRR"
                     class="form-control" id="newProjectDeadline" pattern="^d{2}/d{2}/d{4}$" required>
                </div>
                <div class="col-sm-5">
                    <input type="text" ng-model="project.current.dltime" class="form-control" placeholder="Format: HH:MM" pattern="^d{2}:d{2}$" required>
                </div>
            </div> -->
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button class="btn btn-primary">Zatwierdź</button>
                </div>
            </div>
        </form>
    </div>

    <h2>Zadania</h2>

    <table class="table table-hover">
        <tr>
            <th>Lp.</th><th>Nazwa</th><th>Opis</th><th>Status</th><th>% wykonania</th>
        </tr>
        <tr ng-repeat="task in project.tasks">
            <td>{{ $index+1 }}</td>
            <td><a ui-sref="TasksSingle({ id: project.id })">{{ task.name }}</a></td>
            <td>{{ task.description }}</td>
            <td>{{ task.status | taskstatus }}</td>
            <td>{{ task.progress }}%</td>
        </tr>
    </table>
    <div>
        <button class="btn" ng-click="users.addForm.visible = !users.addForm.visible"
        ng-class="{ 'btn-default': users.addForm.visible, 'btn-primary': !users.addForm.visible }">Dodaj użytkownika</button>
    </div>
    <div ng-if="users.addForm.visible">
        <form ng-submit="users.actions.add()" class="form-inline form-add-user">
            <div class="form-group">
                <input type="text" ng-model="users.newUser.userName" placeholder="Login" class="form-control">
                <input type="password" ng-model="users.newUser.userPass" placeholder="Hasło" class="form-control">
                <input type="text" ng-model="users.newUser.displayName" placeholder="Imię i nazwisko" class="form-control">
                <div class="checkbox">
                    <label><input type="checkbox" ng-model="users.newUser.isAdmin"> Administrator</label>
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Dodaj</button>
            </div>
        </form>
    </div>
</div>
